
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}My App{% endblock %}</title>
  {% set cache_bust = '?v=' ~ range(1000)|random %}
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}{{ cache_bust }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="bg-light">
  <!-- Navbar -->
  <div class="navbar">
    <button class="sidebar-toggle">â˜°</button>
    
    <div class="dropdown">
      <button class="dropbtn">ğŸ‘¤ Profile â–¾</button>
      <ul class="dropdown-menu">
        <li><a href="{{ url_for('profile') }}">My Profile</a></li>
        <li><a href="{{ url_for('logout') }}">Logout</a></li>
      </ul>
    </div>
  </div>

  <!-- Sidebar -->
  <aside class="sidebar">
    <ul>
      <li><a href="{{ url_for('home') }}">ğŸ  Home</a></li>
      <li><a href="{{ url_for('my_tasks') }}">âœ… My Tasks</a></li>
      <li><a href="{{ url_for('projects') }}">ğŸ“ Projects</a></li>
      <li><a href="{{ url_for('inbox') }}">ğŸ”” Inbox</a></li>
    </ul>
  </aside>

  <!-- Page Content -->
  <main class="main-content">
     <!-- ğŸ”” Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-container">
          {% for category, message in messages %}
            <div class="flash-message {{ category }}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <!-- ğŸ§© Page-Specific Content -->

    {% block content %}{% endblock %}
  </main>

  <!-- Footer -->
  <footer class="footer">
    <p>Â© 2025 MyApp. All rights reserved.</p>
  </footer>

  <script>
    // Profile dropdown toggle
    document.querySelectorAll('.dropbtn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        btn.nextElementSibling.classList.toggle('show');
      });
    });

    // Sidebar toggle
    const sidebar = document.querySelector('.sidebar');
    const toggleBtn = document.querySelector('.sidebar-toggle');

    toggleBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      sidebar.classList.toggle('show');
    });

    // Auto close dropdown and sidebar when clicking outside
    document.addEventListener('click', (e) => {
      document.querySelectorAll('.dropdown-menu').forEach(menu => menu.classList.remove('show'));
      if (!sidebar.contains(e.target) && !toggleBtn.contains(e.target)) {
        sidebar.classList.remove('show');
      }
    });

      // ğŸ’« Auto-hide flash messages after 3 seconds
    setTimeout(() => {
      document.querySelectorAll('.flash-message').forEach(msg => {
        msg.classList.add('fade-out');
        setTimeout(() => msg.remove(), 500); // remove after fade
      });
    }, 3000);

  </script>
</body>
</html>
